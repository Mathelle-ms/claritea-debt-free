<!DOCTYPE html>
<html lang="en">
<head>
  <title>Claritea Debt Free Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;background:#f8f9fa;color:#212529;line-height:1.6}
    .container{max-width:900px;margin:0 auto;padding:0 1rem}

    /*  BANNER  */
    .banner{background:linear-gradient(rgba(30,64,175,.85),rgba(30,64,175,.85)),url(https://images.unsplash.com/photo-1553729459-efe14ef6055d?w=1200&h=400&fit=crop) center/cover;color:#fff;padding:4rem 1rem;text-align:center;position:relative;overflow:hidden}
    .wave{position:absolute;bottom:0;left:0;width:200%;height:70px;background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 70"><path fill="%23ffffff" fill-opacity="0.35" d="M0,35 C200,0 400,70 600,35 C800,0 1000,70 1200,35 L1200,70 L0,70 Z"/></svg>') 0 0/600px 70px;animation:waveMove 8s linear infinite}
    @keyframes waveMove{0%{transform:translateX(0)}100%{transform:translateX(-600px)}}
    .banner h1{font-size:2.5rem;margin-bottom:.5rem;letter-spacing:-.5px;animation:textDrop .8s ease-out .3s both}
    .banner p{font-size:1.1rem;opacity:.9;max-width:600px;margin:0 auto;animation:textFadeUp .8s ease-out .6s both}
    #animated-text{color:#fbbf24;animation:pulse 2s ease-in-out infinite}
    @keyframes pulse{0%,100%{opacity:1}50%{opacity:.8}}
    @keyframes textDrop{from{transform:translateY(-20px);opacity:0}to{transform:translateY(0);opacity:1}}
    @keyframes textFadeUp{from{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:.9}}

    /*  COUNTRY  PICKER  */
    .country-bar{background:#eef2ff;padding:1rem;text-align:center;font-size:1rem}
    .country-bar select{padding:.5rem 1rem;font-size:1rem;border-radius:6px;border:2px solid #1e40af;background:#fff;color:#1e293b;cursor:pointer}

    /*  TOOLTIP  */
    .tooltip{position:relative;display:inline-block;margin-left:.4rem;width:18px;height:18px;background:#1e40af;color:#fff;border-radius:50%;text-align:center;line-height:18px;font-size:.75rem;cursor:help;vertical-align:middle}
    .tooltip .tooltiptext{visibility:hidden;width:220px;background:#1e293b;color:#fff;text-align:center;border-radius:6px;padding:.6rem;position:absolute;z-index:1;bottom:125%;left:50%;margin-left:-110px;opacity:0;transition:opacity .3s;font-size:.85rem;line-height:1.4;font-weight:normal}
    .tooltip:hover .tooltiptext{visibility:visible;opacity:1}

    /*  FORMS  */
    .card{background:#fff;padding:1.5rem;margin:1rem 0;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,.05);animation:slideUp .3s ease-out;transition:transform .2s}
    .card:hover{transform:translateY(-2px)}
    .form-group{margin-bottom:1rem}
    label{display:block;font-weight:600;margin-bottom:.5rem}
    input,select{width:100%;padding:.75rem;border:2px solid #d1d5db;border-radius:8px;font-size:1rem;transition:border-color .2s}
    input:focus,select:focus{outline:none;border-color:#1e40af}
    .btn{width:100%;padding:.9rem;background:#1e40af;color:#fff;border:none;border-radius:8px;font-size:1rem;font-weight:600;cursor:pointer;transition:background .2s, transform .1s}
    .btn:hover{background:#1e3a8a}
    .btn:active{transform:scale(.98)}
    .debt-item{background:#f1f5f9;padding:1rem;margin:.5rem 0;border-radius:8px;display:flex;justify-content:space-between;align-items:center;animation:fadeIn .3s ease-in}
    .debt-item span{flex:1;font-weight:500}
    .btn-delete{background:#dc2626;color:#fff;border:none;padding:.4rem .8rem;border-radius:6px;cursor:pointer;font-size:.85rem;font-weight:600}

    /*  NEW  RAMSEY-STYLE  RESULTS  */
    .ramsey-card{background:#fff;padding:2rem;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,.08);margin-top:1rem}
    .result-row{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;margin-bottom:2rem}
    .result-box{padding:1.5rem;border:2px solid #e5e7eb;border-radius:10px;text-align:center}
    .result-box.highlight{border-color:#1e40af;background:#f4f7ff}
    .result-box .label{font-size:.95rem;color:#475569;margin-bottom:.5rem}
    .result-box .date{font-size:1.75rem;font-weight:700;color:#1e293b}
    .result-box .months{font-size:.9rem;color:#64748b}
    /*  GREEN  TEXT  */
    .boost-green{color:#16a34a;font-weight:600;font-size:1.1rem;margin-bottom:.5rem}
    .slider-box{margin:1.5rem 0}
    #extra-slider{width:100%;margin:.5rem 0}
    .slider-labels{display:flex;justify-content:space-between;font-size:.75rem;color:#64748b}
    .plan-grid{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
    @media(max-width:600px){.result-row,.plan-grid{grid-template-columns:1fr}}

    /*  BLUE  main owed box  */
    .result-box.main{
      background:#1e40af;
      color:#fff;
      border-color:#1e40af;
    }
    .result-box.main .label,
    .result-box.main .date,
    .result-box.main .months{
      color:#fff;
    }

    /*  LIGHT-GREEN  when slider > 0  */
    .result-box.boost{
      background:#86efac;
      color:#1e293b;
      border-color:#86efac;
    }
    .result-box.boost .label,
    .result-box.boost .date,
    .result-box.boost .months{
      color:#1e293b;
    }

    /*  SAVING  AMOUNT  â€“  BLACK  &  BOLD  */
    .saving{
      font-size:.9rem;
      color:#000;          /* black */
      font-weight:700;     /* bold */
      margin-top:.4rem;
    }

    /*  CTA  â€“  SAME  GREEN  */
    .cta-green{
      background:#86efac;
      color:#1e293b;
      padding:1rem;
      text-align:center;
      border-radius:8px;
      margin:1rem 0;
      font-weight:600;
    }
    .cta-green h3{margin-bottom:.5rem;font-size:1.1rem}
    .cta-green p{margin-bottom:.5rem;font-size:.9rem}
    .cta-green a{
      color:#1e293b;
      text-decoration:none;
      font-weight:700;
    }
    .cta-green a:hover{text-decoration:underline}

    /*  EDU  SECTIONS  â€“  WILL  BE  HIDDEN  AFTER  RESULTS  */
    .edu-section{background:#fff;padding:2rem;margin:2rem 0;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,.05)}
    .edu-section h2{color:#1e40af;margin-bottom:1rem;font-size:1.8rem}
    .edu-section h3{color:#1e293b;margin:1.5rem 0 .5rem 0;font-size:1.3rem}
    .edu-section p{margin-bottom:1rem;color:#475569;line-height:1.7}
    .edu-section ul{margin-left:2rem;margin-bottom:1rem}
    .edu-section li{margin-bottom:.5rem;color:#475569;line-height:1.6}
    .term-box{background:#f1f5f9;padding:1rem;border-radius:8px;margin:1rem 0;border-left:4px solid #1e40af}
    .term-box h4{color:#1e40af;margin-bottom:.5rem}
    .hidden{display:none}
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
    @keyframes slideUp{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
  </style>
</head>
<body>

  <!--  BANNER  -->
  <div class="banner">
    <div class="wave"></div>
    <h1>Claritea Debt Free <span id="animated-text">Calculator</span></h1>
    <p>See exactly when youâ€™ll be debt-free. No signup. No credit score needed</p>
  </div>

  <!--  COUNTRY  PICKER  -->
  <div class="country-bar">
    <label for="country" style="margin-right:.5rem;">Choose your country:</label>
    <select id="country" onchange="switchCountry(this.value)">
      <option value="US">ðŸ‡ºðŸ‡¸ United States</option>
      <option value="FR">ðŸ‡«ðŸ‡· France</option>
      <option value="ES">ðŸ‡ªðŸ‡¸ Spain</option>
    </select>
  </div>

  <div class="container">

    <!--  ADD-DEBT FORM  -->
    <div class="card">
      <h3 data-i18n="addDebtTitle">Add a Debt</h3>
      <div class="form-group">
        <label data-i18n="debtType">Debt Type</label>
        <span class="tooltip">i<span class="tooltiptext" data-i18n="debtTypeTip">What kind of debt is this?</span></span>
        <select id="debt-type">
          <option value="" data-i18n="selectType">Select debt type...</option>
          <option>Car Loan</option><option>Student Loan</option><option>Credit Card</option>
          <option>Other Debt</option>
          <!--  HOME  MORTGAGE  REMOVED  -->
        </select>
      </div>
      <div class="form-group">
        <label data-i18n="balance">Balance Owed</label>
        <span class="tooltip">i<span class="tooltiptext" data-i18n="balanceTip">How much do you still owe?</span></span>
        <input id="balance" type="number" placeholder="e.g., 5000">
      </div>
      <div class="form-group">
        <label data-i18n="apr">Interest Rate (APR)</label>
        <span class="tooltip">i<span class="tooltiptext" data-i18n="aprTip">Yearly rate on your bill</span></span>
        <input id="apr" type="number" step="0.01" placeholder="e.g., 18.99">
      </div>
      <div class="form-group">
        <label data-i18n="minPayment">Minimum Payment</label>
        <span class="tooltip">i<span class="tooltiptext" data-i18n="minPaymentTip">Smallest amount required monthly</span></span>
        <input id="min-payment" type="number" placeholder="e.g., 100">
      </div>
      <!--  EXTRA  MONTHLY  PAYMENT  FIELD  REMOVED  -->

      <!--  ADD DEBT  -->
      <button class="btn" onclick="addDebt()"><span data-i18n="addDebtBtn">Add Debt â†’</span></button>
    </div>

    <!--  DEBT LIST  -->
    <div id="debt-list" class="card hidden">
      <h3 data-i18n="yourDebts">Your Debts</h3>
      <div id="debts"></div>
    </div>

    <!--  CALCULATE  -->
    <div class="card">
      <button class="btn" onclick="calculate()"><span data-i18n="seeDateBtn">See My Debt-Free Date â†’</span></button>
    </div>

    <!--  RESULTS â€“ RAMSEY STYLE WITH LIVE SLIDER  -->
    <div id="results" class="hidden">
      <div class="ramsey-card">
        <h2 data-i18n="debtFreeDate">Your Debt-Free Date</h2>
        <div class="result-row">
          <div class="result-box main">
            <div class="label" data-i18n="minOnly">If you continue making only minimum payments:</div>
            <div class="date" id="min-date">â€”</div>
            <div class="months" id="min-months">â€”</div>
          </div>
          <div class="result-box highlight" id="extra-box" style="display:none">
            <div class="label"><span data-i18n="ifYouPay">If you pay</span> <strong id="extra-val">$0</strong> <span data-i18n="extraEachMonth">extra each month:</span></div>
            <div class="date" id="new-date">â€”</div>
            <div class="months" id="new-months">â€”</div>
            <div class="saving" id="saving-amount">Youâ€™ll save $0</div>
          </div>
        </div>

        <div class="slider-box" id="slider-box">
          <p class="boost-green" data-i18n="boostText">Want to be debt-free sooner? Of course you do!</p>
          <label data-i18n="boostLabel">Boost your payments to pay off your debt even faster!</label>
          <input type="range" id="extra-slider" min="0" max="10000" step="25" value="0">
          <div class="slider-labels">
            <span>$0</span><span>$2.5k</span><span>$5k</span><span>$7.5k</span><span>$10k</span>
          </div>
        </div>

        <!--  NEW  LOSS  &  NET  LOSS  BOXES  -->
        <div style="margin-top:1rem;display:grid;grid-template-columns:1fr 1fr;gap:1rem;">
          <div class="result-box" style="border-color:#dc2626;background:#fee2e2;">
            <div class="label" data-i18n="youLose">If you only pay minimums youâ€™ll lose:</div>
            <div class="date" id="loss-amount" style="color:#dc2626;">â€”</div>
          </div>
          <div class="result-box" style="border-color:#16a34a;background:#dcfce7;">
            <div class="label" data-i18n="netLoss">Net loss after extra payments:</div>
            <div class="date" id="net-loss" style="color:#16a34a;">â€”</div>
          </div>
        </div>

        <!--  SNOW / AVALANCHE  CARDS  REMOVED  -->
      </div>
    </div>

    <!--  CTAs  â€“  SAME  GREEN  STYLE  -->
    <div id="cta-panel" class="hidden">
      <div class="cta-green">
        <h3>ðŸ’³ <span data-i18n="cta1Title">Cut Your Interest in Half</span></h3>
        <p data-i18n="cta1Text">A 0% balance-transfer card could save you $1,000+</p>
        <a href="https://credible.com/your-affiliate-link" target="_blank" data-i18n="cta1Btn">â†’ Check If You Qualify (Takes 2 Minutes)</a>
      </div>
      <div class="cta-green">
        <h3>ðŸ’° <span data-i18n="cta2Title">Lower Your Monthly Payment</span></h3>
        <p data-i18n="cta2Text">Consolidate into one loan with a lower rate</p>
        <a href="https://www.lendingtree.com/your-affiliate-link" target="_blank" data-i18n="cta2Btn">â†’ See Your Options (No Impact on Credit)</a>
      </div>
    </div>

    <!--  EDUCATIONAL SECTIONS  â€“  WILL  BE  HIDDEN  AFTER  RESULTS  -->
    <div id="edu-panel">
      <div class="edu-section">
        <h2 data-i18n="whatIsSnowball">What Is the Debt Snowball?</h2>
        <p data-i18n="snowballDesc">The debt snowball is a simple way to pay off debt by focusing on balances, not interest rates.</p>
        <ul>
          <li data-i18n="step1">Step 1: List debts smallest to largest.</li>
          <li data-i18n="step2">Step 2: Pay minimums on all except the smallest.</li>
          <li data-i18n="step3">Step 3: Attack the smallest with every extra dollar.</li>
          <li data-i18n="step4">Step 4: Repeat until every debt is paid off.</li>
        </ul>
      </div>
      <div class="edu-section">
        <h2 data-i18n="vsAvalanche">Debt Snowball vs. Debt Avalanche</h2>
        <p data-i18n="vsDesc">Momentum beats perfect math every time.</p>
      </div>
      <div class="edu-section">
        <h2 data-i18n="termsTitle">Debt Terms Explained (Simple!)</h2>
        <div class="term-box"><h4 data-i18n="minPayTerm">Minimum Payment</h4><p data-i18n="minPayDef">Smallest amount your lender requires.</p></div>
        <div class="term-box"><h4 data-i18n="balanceTerm">Balance</h4><p data-i18n="balanceDef">Amount you still owe.</p></div>
        <div class="term-box"><h4 data-i18n="aprTerm">Interest Rate</h4><p data-i18n="aprDef">Cost of borrowing money.</p></div>
        <div class="term-box"><h4 data-i18n="principalTerm">Principal</h4><p data-i18n="principalDef">Original amount borrowed.</p></div>
        <div class="term-box"><h4 data-i18n="nonMortTerm">Nonmortgage Debt</h4><p data-i18n="nonMortDef">All debt except your home loan.</p></div>
        <div class="term-box"><h4 data-i18n="dfDateTerm">Debt-Free Date</h4><p data-i18n="dfDateDef">The day your consumer debt hits zero.</p></div>
      </div>
    </div>

  </div>

  <!--  SUPABASE + SCRIPTS  -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    /* ---------- 1.  locale map : language + currency ---------- */
    const LOCALES = {
      US: { lang: 'en', currency: 'USD', symbol: '$' },
      FR: { lang: 'fr', currency: 'EUR', symbol: 'â‚¬' },
      ES: { lang: 'es', currency: 'EUR', symbol: 'â‚¬' }
    };

    const TEXTS = {
      en: {
        addDebtTitle: 'Add a Debt', selectType: 'Select debt type...', debtType: 'Debt Type', debtTypeTip: 'What kind of debt is this?',
        balance: 'Balance Owed', balanceTip: 'How much do you still owe?', apr: 'Interest Rate (APR)', aprTip: 'Yearly rate on your bill',
        minPayment: 'Minimum Payment', minPaymentTip: 'Smallest amount required monthly', addDebtBtn: 'Add Debt â†’',
        yourDebts: 'Your Debts', seeDateBtn: 'See My Debt-Free Date â†’', debtFreeDate: 'Your Debt-Free Date',
        minOnly: 'If you continue making only minimum payments:', ifYouPay: 'If you pay', extraEachMonth: 'extra each month:',
        boostText: 'Want to be debt-free sooner? Of course you do!', boostLabel: 'Boost your payments to pay off your debt even faster!',
        youLose: 'If you only pay minimums youâ€™ll lose:', netLoss: 'Net loss after extra payments:', savingPrefix: 'Youâ€™ll save',
        whatIsSnowball: 'What Is the Debt Snowball?', snowballDesc: 'The debt snowball is a simple way to pay off debt by focusing on balances, not interest rates.',
        step1: 'Step 1: List debts smallest to largest.', step2: 'Step 2: Pay minimums on all except the smallest.', step3: 'Step 3: Attack the smallest with every extra dollar.', step4: 'Step 4: Repeat until every debt is paid off.',
        vsAvalanche: 'Debt Snowball vs. Debt Avalanche', vsDesc: 'Momentum beats perfect math every time.',
        termsTitle: 'Debt Terms Explained (Simple!)', minPayTerm: 'Minimum Payment', minPayDef: 'Smallest amount your lender requires.',
        balanceTerm: 'Balance', balanceDef: 'Amount you still owe.', aprTerm: 'Interest Rate', aprDef: 'Cost of borrowing money.',
        principalTerm: 'Principal', principalDef: 'Original amount borrowed.', nonMortTerm: 'Nonmortgage Debt', nonMortDef: 'All debt except your home loan.',
        dfDateTerm: 'Debt-Free Date', dfDateDef: 'The day your consumer debt hits zero.',
        cta1Title: 'Cut Your Interest in Half', cta1Text: 'A 0% balance-transfer card could save you $1,000+', cta1Btn: 'â†’ Check If You Qualify (Takes 2 Minutes)',
        cta2Title: 'Lower Your Monthly Payment', cta2Text: 'Consolidate into one loan with a lower rate', cta2Btn: 'â†’ See Your Options (No Impact on Credit)'
      },
      fr: {
        addDebtTitle: 'Ajouter une Dette', selectType: 'SÃ©lectionner le type de dette...', debtType: 'Type de Dette', debtTypeTip: 'Quel type de dette est-ce ?',
        balance: 'Solde Restant', balanceTip: 'Combien devez-vous encore ?', apr: 'Taux dâ€™IntÃ©rÃªt (TAEG)', aprTip: 'Taux annuel indiquÃ© sur votre relevÃ©',
        minPayment: 'Paiement Minimum', minPaymentTip: 'Le plus petit montant requis chaque mois', addDebtBtn: 'Ajouter la Dette â†’',
        yourDebts: 'Vos Dettes', seeDateBtn: 'Voir ma Date de LibÃ©ration â†’', debtFreeDate: 'Votre Date de LibÃ©ration de Dette',
        minOnly: 'Si vous continuez Ã  payer uniquement les minimums :', ifYouPay: 'Si vous payez', extraEachMonth: 'supplÃ©mentaires par mois :',
        boostText: 'Vous voulez Ãªtre libre de dette plus tÃ´t ? Bien sÃ»r !', boostLabel: 'Augmentez vos paiements pour rembourser plus vite !',
        youLose: 'Si vous ne payez que les minimums vous perdrez :', netLoss: 'Perte nette aprÃ¨s paiements supplÃ©mentaires :', savingPrefix: 'Vous Ã©conomiserez',
        whatIsSnowball: 'Quâ€™est-ce que la Boule de Neige ?', snowballDesc: 'La boule de neige est une mÃ©thode simple qui se concentre sur les soldes, pas sur les taux.',
        step1: 'Ã‰tape 1 : Listez vos dettes du plus petit au plus grand.', step2: 'Ã‰tape 2 : Payez les minimums sur toutes sauf la plus petite.', step3: 'Ã‰tape 3 : Attaquez la plus petite avec tous les dollars supplÃ©mentaires.', step4: 'Ã‰tape 4 : RÃ©pÃ©tez jusquâ€™Ã  zÃ©ro.',
        vsAvalanche: 'Boule de Neige vs. Avalanche', vsDesc: 'La dynamique bat la mathÃ©matique parfaite Ã  chaque fois.',
        termsTitle: 'Termes de Dette ExpliquÃ©s (Simple !)', minPayTerm: 'Paiement Minimum', minPayDef: 'Le plus petit montant exigÃ© par le prÃªteur.',
        balanceTerm: 'Solde', balanceDef: 'Montant que vous devez encore.', aprTerm: 'Taux dâ€™IntÃ©rÃªt', aprDef: 'CoÃ»t de lâ€™argent empruntÃ©.',
        principalTerm: 'Principal', principalDef: 'Montant initial empruntÃ©.', nonMortTerm: 'Dette Non-HypothÃ©caire', nonMortDef: 'Toute dette sauf le prÃªt immobilier.',
        dfDateTerm: 'Date de LibÃ©ration', dfDateDef: 'Le jour oÃ¹ votre dette consommation atteint zÃ©ro.',
        cta1Title: 'RÃ©duisez votre IntÃ©rÃªt de MoitiÃ©', cta1Text: 'Une carte de transfert Ã  0 % peut vous faire Ã©conomiser 1 000 â‚¬+', cta1Btn: 'â†’ VÃ©rifiez si vous Qualifiez (2 min)',
        cta2Title: 'RÃ©duisez votre MensualitÃ©', cta2Text: 'Regroupez en un prÃªt Ã  taux plus bas', cta2Btn: 'â†’ Voir les Options (sans impact crÃ©dit)'
      },
      es: {
        addDebtTitle: 'AÃ±adir una Deuda', selectType: 'Selecciona tipo de deuda...', debtType: 'Tipo de Deuda', debtTypeTip: 'Â¿QuÃ© tipo de deuda es Ã©sta?',
        balance: 'Saldo Pendiente', balanceTip: 'Â¿CuÃ¡nto debes todavÃ­a?', apr: 'Tasa de InterÃ©s (TAE)', aprTip: 'Tasa anual que aparece en tu extracto',
        minPayment: 'Pago MÃ­nimo', minPaymentTip: 'La cantidad mÃ¡s pequeÃ±a que debes pagar cada mes', addDebtBtn: 'AÃ±adir Deuda â†’',
        yourDebts: 'Tus Deudas', seeDateBtn: 'Ver mi Fecha Libre de Deuda â†’', debtFreeDate: 'Tu Fecha Libre de Deuda',
        minOnly: 'Si continÃºas pagando solo los mÃ­nimos:', ifYouPay: 'Si pagas', extraEachMonth: 'extra cada mes:',
        boostText: 'Â¿Quieres estar libre de deuda antes? Â¡Claro que sÃ­!', boostLabel: 'Aumenta tus pagos para pagar la deuda mÃ¡s rÃ¡pido.',
        youLose: 'Si solo pagas mÃ­nimos perderÃ¡s:', netLoss: 'PÃ©rdida neta despuÃ©s de pagos extra:', savingPrefix: 'AhorrarÃ¡s',
        whatIsSnowball: 'Â¿QuÃ© es la Bola de Nieve?', snowballDesc: 'La bola de nieve es una forma simple de pagar deudas centrÃ¡ndose en los saldos, no en los tipos.',
        step1: 'Paso 1: Lista tus deudas de menor a mayor.', step2: 'Paso 2: Paga mÃ­nimos en todas excepto la mÃ¡s pequeÃ±a.', step3: 'Paso 3: Ataca la mÃ¡s pequeÃ±a con todos los dÃ³lares extra.', step4: 'Paso 4: Repite hasta cero.',
        vsAvalanche: 'Bola de Nieve vs. Avalancha', vsDesc: 'La dinÃ¡mica vence a la matemÃ¡tica perfecta cada vez.',
        termsTitle: 'TÃ©rminos de Deuda Explicados (Â¡Simple!)', minPayTerm: 'Pago MÃ­nimo', minPayDef: 'La cantidad mÃ¡s pequeÃ±a que exige el prestamista.',
        balanceTerm: 'Saldo', balanceDef: 'Cantidad que debes todavÃ­a.', aprTerm: 'Tasa de InterÃ©s', aprDef: 'Costo del dinero prestado.',
        principalTerm: 'Principal', principalDef: 'Cantidad inicial que pediste prestada.', nonMortTerm: 'Deuda No-Hipotecaria', nonMortDef: 'Toda deuda excepto tu prÃ©stamo hipotecario.',
        dfDateTerm: 'Fecha Libre de Deuda', dfDateDef: 'El dÃ­a en que tu deuda de consumo llega a cero.',
        cta1Title: 'Corta tu InterÃ©s a la Mitad', cta1Text: 'Una tarjeta de transferencia al 0 % puede ahorrarte 1 000 â‚¬+', cta1Btn: 'â†’ Comprueba si Calificas (2 min)',
        cta2Title: 'Reduce tu Pago Mensual', cta2Text: 'Consolida en un prÃ©stamo con tasa mÃ¡s baja', cta2Btn: 'â†’ Ver Opciones (sin impacto crÃ©dito)'
      }
    };

    /* ---------- 2.  core calculate (hoisted) ---------- */
    let debtSnapshot = [], minInterest = 0, currentSymbol = '$';   // symbol added
    async function calculate() {
      const { data: debts } = await supabaseClient.from('debts').select('*');
      if (!debts || !debts.length) { alert('Please add at least one debt first.'); return; }

      const baseSave = simulate(debts);
      minInterest = baseSave.interest;

      const minDate = monthOffset(new Date(), baseSave.months);
      document.getElementById('min-date').textContent = minDate;
      document.getElementById('min-months').textContent = `${baseSave.months} months`;

      /* show fixed loss with correct currency */
      document.getElementById('loss-amount').textContent =
        formatMoney(minInterest, currentSymbol);

      debtSnapshot = JSON.parse(JSON.stringify(debts));

      const slider = document.getElementById('extra-slider');
      slider.value = 0;
      slider.dispatchEvent(new Event('input'));

      /* show card & CTAs ,  HIDE  EDU  SECTIONS  */
      document.getElementById('results').classList.remove('hidden');
      document.getElementById('cta-panel').classList.remove('hidden');
      document.getElementById('edu-panel').classList.add('hidden');

      // â†“â†“â†“  SMOOTH  SCROLL  to results  â†“â†“â†“
      document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    /* ---------- 3.  slider live update + color switch + saving + net loss ---------- */
    const slider = document.getElementById('extra-slider');
    const extraVal = document.getElementById('extra-val');
    const extraBox = document.getElementById('extra-box');
    const newDateEl = document.getElementById('new-date');
    const newMonthsEl = document.getElementById('new-months');
    const savingEl = document.getElementById('saving-amount');
    const netLossEl = document.getElementById('net-loss');

    slider.addEventListener('input', () => {
      const extra = parseInt(slider.value, 10);
      extraVal.textContent = formatMoney(extra, currentSymbol);
      if (extra === 0) {
        extraBox.style.display = 'none';
        extraBox.classList.remove('boost');
        return;
      }
      extraBox.style.display = 'block';
      extraBox.classList.add('boost');

      const withExtra = debtSnapshot.map(d => ({ ...d, extra_payment: (d.extra_payment || 0) + extra }));
      const res = simulate(withExtra);

      newDateEl.textContent = monthOffset(new Date(), res.months);
      newMonthsEl.textContent = `${res.months} months`;

      //  LIVE  SAVING  AMOUNT  â€“  BLACK  &  BOLD
      const saved = minInterest - res.interest;
      savingEl.textContent = `${TEXTS[LOCALES[document.getElementById('country').value].lang].savingPrefix} ${formatMoney(saved, currentSymbol)}`;

      //  LIVE  NET  LOSS  (lose âˆ’ save)  â†’  drops  toward  zero
      const net = minInterest - saved;
      netLossEl.textContent = formatMoney(net, currentSymbol);
    });

    /* ---------- 4.  debt CRUD ---------- */
    async function addDebt() {
      const debt = {
        type: document.getElementById('debt-type').value,
        balance: parseFloat(document.getElementById('balance').value),
        apr: parseFloat(document.getElementById('apr').value),
        min_payment: parseFloat(document.getElementById('min-payment').value),
        extra_payment: 0   //  no longer collected from form
      };
      if (!debt.type || isNaN(debt.balance) || isNaN(debt.apr) || isNaN(debt.min_payment)) {
        alert('Please fill in all required fields.'); return;
      }
      await supabaseClient.from('debts').insert([debt]);
      loadDebts();
    }
    async function deleteDebt(id) {
      await supabaseClient.from('debts').delete().eq('id', id);
      loadDebts();
    }
    async function loadDebts() {
      const { data } = await supabaseClient.from('debts').select('*');
      const list = document.getElementById('debt-list');
      const container = document.getElementById('debts');
      if (data && data.length) {
        list.classList.remove('hidden');
        container.innerHTML = data.map(d => `
          <div class="debt-item">
            <span>${d.type}: ${formatMoney(d.balance, currentSymbol)} at ${d.apr}%</span>
            <button class="btn-delete" onclick="deleteDebt(${d.id})">Delete</button>
          </div>`).join('');
      } else { list.classList.add('hidden'); }
    }

    /* ---------- 5.  supabase client + initial load ---------- */
    const supabaseClient = supabase.createClient(
      'https://gqgpjneoobcopymsvohx.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdxZ3BqbmVvb2Jjb3B5bXN2b2h4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU1ODE2NzgsImV4cCI6MjA4MTE1NzY3OH0.j_URS7960PNFOrcDNaP-C3dxzXbCsPW1AfOmncV5A68'
    );
    loadDebts();

    /* ---------- 6.  animated headline (nice-to-have) ---------- */
    const phrases = ['Calculator', 'Strategy', 'Timeline'];
    let idx = 0;
    setInterval(() => {
      idx = (idx + 1) % phrases.length;
      document.getElementById('animated-text').textContent = phrases[idx];
    }, 3000);

    /* ---------- 7.  language + currency switcher ---------- */
    function formatMoney(amount, symbol) {
      return symbol + amount.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }
    function switchCountry(code) {
      const loc = LOCALES[code];
      currentSymbol = loc.symbol;
      // translate all [data-i18n] elements
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (TEXTS[loc.lang][key]) el.textContent = TEXTS[loc.lang][key];
      });
      // re-render debt list with new currency
      loadDebts();
      // if results are open, re-render them
      const results = document.getElementById('results');
      if (!results.classList.contains('hidden')) calculate();
    }
    // init on load
    switchCountry('US');
  </script>
</body>
</html>
