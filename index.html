<!DOCTYPE html>
<html lang="en">
<head>
  <title>Claritea Debt Free Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    /* --------------  CSS (unchanged)  -------------- */
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:#f8f9fa;color:#212529;line-height:1.6}
    .container{max-width:900px;margin:0 auto;padding:0 1rem}
    .banner{background:linear-gradient(rgba(30,64,175,.85),rgba(30,64,175,.85)),url(https://images.unsplash.com/photo-1553729459-efe14ef6055d?w=1200&h=400&fit=crop);background-size:cover;background-position:center;color:#fff;padding:4rem 1rem;text-align:center;position:relative;overflow:hidden;animation:bannerSlide 1s ease-out}
    .wave{position:absolute;bottom:0;left:0;width:200%;height:70px;background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 70"><path fill="%23ffffff" fill-opacity="0.35" d="M0,35 C200,0 400,70 600,35 C800,0 1000,70 1200,35 L1200,70 L0,70 Z"></path></svg>');background-size:600px 70px;animation:waveMove 8s linear infinite}
    @keyframes waveMove{0%{transform:translateX(0)}100%{transform:translateX(-600px)}}
    .banner h1{font-size:2.5rem;margin-bottom:.5rem;letter-spacing:-.5px;animation:textDrop .8s ease-out .3s both;position:relative;z-index:2}
    .banner p{font-size:1.1rem;opacity:.9;max-width:600px;margin:0 auto;animation:textFadeUp .8s ease-out .6s both;position:relative;z-index:2}
    #animated-text{color:#fbbf24;animation:pulse 2s ease-in-out infinite}
    @keyframes pulse{0%,100%{opacity:1}50%{opacity:.8}}
    @keyframes bannerSlide{from{transform:translateY(-30px);opacity:0}to{transform:translateY(0);opacity:1}}
    @keyframes textDrop{from{transform:translateY(-20px);opacity:0}to{transform:translateY(0);opacity:1}}
    @keyframes textFadeUp{from{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:.9}}
    .tooltip{position:relative;display:inline-block;margin-left:.4rem;width:18px;height:18px;background:#1e40af;color:#fff;border-radius:50%;text-align:center;line-height:18px;font-size:.75rem;cursor:help;vertical-align:middle}
    .tooltip .tooltiptext{visibility:hidden;width:220px;background:#1e293b;color:#fff;text-align:center;border-radius:6px;padding:.6rem;position:absolute;z-index:1;bottom:125%;left:50%;margin-left:-110px;opacity:0;transition:opacity .3s;font-size:.85rem;line-height:1.4;font-weight:normal}
    .tooltip:hover .tooltiptext{visibility:visible;opacity:1}
    .card{background:#fff;padding:1.5rem;margin:1rem 0;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,.05);animation:slideUp .3s ease-out;transition:transform .2s}
    .card:hover{transform:translateY(-2px)}
    .form-group{margin-bottom:1rem}
    label{display:block;font-weight:600;margin-bottom:.5rem}
    input,select{width:100%;padding:.75rem;border:2px solid #d1d5db;border-radius:8px;font-size:1rem;transition:border-color .2s;background:#fff}
    input:focus,select:focus{outline:none;border-color:#1e40af}
    .btn{width:100%;padding:.9rem;background:#1e40af;color:#fff;border:none;border-radius:8px;font-size:1rem;font-weight:600;cursor:pointer;transition:background .2s,transform .1s}
    .btn:hover{background:#1e3a8a}
    .btn:active{transform:scale(.98)}
    .debt-item{background:#f1f5f9;padding:1rem;margin:.5rem 0;border-radius:8px;display:flex;justify-content:space-between;align-items:center;animation:fadeIn .3s ease-in}
    .debt-item span{flex:1;font-weight:500}
    .btn-delete{background:#dc2626;color:#fff;border:none;padding:.4rem .8rem;border-radius:6px;cursor:pointer;font-size:.85rem;font-weight:600}
    .results-grid{display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-top:1rem}
    .plan{background:#1e40af;color:#fff;padding:1.5rem;border-radius:12px;animation:fadeIn .5s ease-in}
    .plan h3{color:#60a5fa;margin-bottom:.5rem}
    .plan p{margin:.3rem 0;font-size:.95rem}
    @media (max-width:600px){.results-grid{grid-template-columns:1fr}}
    .edu-section{background:#fff;padding:2rem;margin:2rem 0;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,.05);animation:slideUp .5s ease-out}
    .edu-section h2{color:#1e40af;margin-bottom:1rem;font-size:1.8rem}
    .edu-section h3{color:#1e293b;margin:1.5rem 0 .5rem;font-size:1.3rem}
    .edu-section p{margin-bottom:1rem;color:#475569;line-height:1.7}
    .edu-section ul{margin-left:2rem;margin-bottom:1rem}
    .edu-section li{margin-bottom:.5rem;color:#475569;line-height:1.6}
    .edu-section .term-box{background:#f1f5f9;padding:1rem;border-radius:8px;margin:1rem 0;border-left:4px solid #1e40af}
    .edu-section .term-box h4{color:#1e40af;margin-bottom:.5rem}
    .cta{background:#60a5fa;color:#1e293b;padding:1rem;text-align:center;border-radius:8px;margin:1rem 0;font-weight:600;animation:fadeIn .5s ease-in}
    .cta a{color:#1e293b;text-decoration:none;display:block;font-weight:700}
    .cta a:hover{text-decoration:underline}
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
    @keyframes slideUp{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
    .hidden{display:none}
  </style>
</head>
<body>
  <!-- Banner with wave -->
  <div class="banner">
    <div class="wave"></div>
    <h1>Claritea Debt Free <span id="animated-text">Calculator</span></h1>
    <p>See exactly when youâ€™ll be debt-free. No signup. No credit score needed</p>
  </div>

  <div class="container">
    <!-- =====  ADD-DEBT CARD  ===== -->
    <div class="card">
      <h3>Add a Debt</h3>
      <div class="form-group">
        <label>Debt Type <span class="tooltip">i<span class="tooltiptext">What kind of debt is this?</span></span></label>
        <select id="debt-type"><option value="">Select debt typeâ€¦</option><option>Car Loan</option><option>Student Loan</option><option>Credit Card</option><option>Other Debt</option></select>
      </div>
      <div class="form-group"><label>Balance Owed <span class="tooltip">i<span class="tooltiptext">How much do you still owe?</span></span></label><input id="balance" type="number" placeholder="e.g. 5000"></div>
      <div class="form-group"><label>Interest Rate (APR %) <span class="tooltip">i<span class="tooltiptext">Yearly rate shown on your bill</span></span></label><input id="apr" type="number" step="0.01" placeholder="e.g. 18.99"></div>
      <div class="form-group"><label>Minimum Payment <span class="tooltip">i<span class="tooltiptext">Required monthly payment</span></span></label><input id="min-payment" type="number" placeholder="e.g. 100"></div>
      <div class="form-group"><label>Extra Monthly Payment (optional) <span class="tooltip">i<span class="tooltiptext">Pay extra to finish faster!</span></span></label><input id="extra-payment" type="number" placeholder="e.g. 50"></div>
      <button id="add-debt-btn" class="btn">Add Debt â†’</button>
    </div>

    <!-- =====  DEBT LIST  ===== -->
    <div id="debt-list" class="card hidden">
      <h3>Your Debts</h3>
      <div id="debts"></div>
      <!--  MISSING BUTTON ADDED HERE  -->
      <button id="calc-btn" class="btn" style="margin-top:1rem">See My Debt-Free Date â†’</button>
    </div>

    <!-- =====  RESULTS  ===== -->
    <div id="results" class="card hidden">
      <h3>Your Debt-Free Date</h3>
      <div class="results-grid">
        <div id="snowball" class="plan"></div>
        <div id="avalanche" class="plan"></div>
      </div>
    </div>

    <!-- =====  EDU SECTIONS  ===== -->
    <div class="edu-section"><h2>What Is the Debt Snowball?</h2>
      <p><strong>The debt snowball is the fastest way to get out of debt.</strong></p><p>Start with the smallest balance, pay it off aggressively, then roll its payment into the next oneâ€”momentum beats math.</p>
    </div>
    <div class="edu-section"><h2>Debt Snowball vs. Debt Avalanche</h2>
      <p>Avalanche targets highest interest first; snowball gives quick winsâ€”so people actually finish.</p>
    </div>
    <div class="edu-section"><h2>Debt Terms Explained (Simple!)</h2>
      <div class="term-box"><h4>Minimum Payment</h4><p>Smallest amount you must pay monthly.</p></div>
      <div class="term-box"><h4>Balance</h4><p>What you still owe.</p></div>
      <div class="term-box"><h4>Interest Rate</h4><p>Cost of borrowing, shown as %.</p></div>
      <div class="term-box"><h4>Principal</h4><p>Original amount borrowed.</p></div>
      <div class="term-box"><h4>Debt-Free Date</h4><p>The day your consumer debt hits $0.</p></div>
    </div>
  </div>

  <!-- ==========  JS  ========== -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    /* ----  animated headline  ---- */
    const phrases = ['Calculator','Strategy','Timeline'];
    let idx = 0;
    const animatedText = document.getElementById('animated-text');
    setInterval(() => {
      idx = (idx + 1) % phrases.length;
      animatedText.textContent = phrases[idx];
    }, 3000);

    /* ----  Supabase  ---- */
    const SUPABASE_URL = 'https://gqgpjneoobcopymsvohx.supabase.co';   // <-- your URL
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdxZ3BqbmVvb2Jjb3B5bXN2b2h4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU1ODE2NzgsImV4cCI6MjA4MTE1NzY3OH0.j_URS7960PNFOrcDNaP-C3dxzXbCsPW1AfOmncV5A68';      // <-- your anon key
    const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    /* ----  add debt  ---- */
    async function addDebt() {
      const debt = {
        type: document.getElementById('debt-type').value,
        balance: parseFloat(document.getElementById('balance').value),
        apr: parseFloat(document.getElementById('apr').value),
        min_payment: parseFloat(document.getElementById('min-payment').value),
        extra_payment: parseFloat(document.getElementById('extra-payment').value) || 0
      };
      if (!debt.type || !debt.balance || !debt.apr || !debt.min_payment) { alert('Please fill in all required fields.'); return; }
      await sb.from('debts').insert([debt]);
      loadDebts();
      document.querySelectorAll('#debt-type, #balance, #apr, #min-payment, #extra-payment').forEach(i => i.value = '');
    }

    /* ----  load / delete  ---- */
    async function loadDebts() {
      const { data } = await sb.from('debts').select('*');
      const list = document.getElementById('debt-list');
      const debtsDiv = document.getElementById('debts');
      if (data && data.length) {
        list.classList.remove('hidden');
        debtsDiv.innerHTML = data.map(d => `
          <div class="debt-item">
            <span>${d.type}: $${d.balance.toFixed(2)} at ${d.apr}%</span>
            <button class="btn-delete" onclick="deleteDebt(${d.id})">Delete</button>
          </div>`).join('');
      } else {
        list.classList.add('hidden');
      }
    }
    async function deleteDebt(id) {
      await sb.from('debts').delete().eq('id', id);
      loadDebts();
    }

    /* ----  calculate  ---- */
    async function calculate() {
      const { data: debts } = await sb.from('debts').select('*');
      if (!debts || !debts.length) return alert('Please add at least one debt first.');
      const snowball = simulate([...debts].sort((a, b) => a.balance - b.balance));
      const avalanche = simulate([...debts].sort((a, b) => b.apr - a.apr));

      document.getElementById('snowball').innerHTML = `
        <h3>ðŸ”„ Debt Snowball</h3>
        <p><strong>Payoff Time:</strong> ${snowball.months} months</p>
        <p><strong>Total Interest:</strong> $${snowball.interest.toFixed(2)}</p>
        <p style="font-size:0.9rem;margin-top:0.5rem">Pay smallest debts first for quick wins.</p>`;

      document.getElementById('avalanche').innerHTML = `
        <h3>ðŸ“ˆ Debt Avalanche</h3>
        <p><strong>Payoff Time:</strong> ${avalanche.months} months</p>
        <p><strong>Total Interest:</strong> $${avalanche.interest.toFixed(2)}</p>
        <p style="font-size:0.9rem;margin-top:0.5rem">Pay highest interest first to save the most money.</p>`;

      document.getElementById('results').classList.remove('hidden');
    }

    function simulate(debts) {
      let months = 0, totalInterest = 0;
      const rem = JSON.parse(JSON.stringify(debts));
      while (rem.some(d => d.balance > 0)) {
        rem.forEach(d => {
          if (d.balance > 0) {
            const interest = d.balance * (d.apr / 100) / 12;
            const pay = Math.min(d.min_payment + (d.extra_payment || 0), d.balance + interest);
            d.balance = Math.max(0, d.balance - (pay - interest));
            totalInterest += interest;
          }
        });
        months++;
      }
      return { months, interest: totalInterest };
    }

    /* ----  wire buttons  ---- */
    document.getElementById('add-debt-btn').addEventListener('click', addDebt);
    document.getElementById('calc-btn').addEventListener('click', calculate);   // <-- NEW

    /* initial load */
    loadDebts();
  </script>
</body>
</html>
